<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" >
<HTML>
<HEAD>
<title>[$cms_version]</title>
<meta http-equiv="Content-Type" content="text/html; charset=[$charset]" />
<meta name="robots" content="noindex">		
<link rel='stylesheet' type='text/css' href='../html/style.css' />
<script src="ui.php?sId=[$sId]&o=functions.js"></script>
<BODY   style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">

<script language='JavaScript'>
var doImage = doImage;
var TType = TType;
var popupWin=null;
function mhHover(tbl, idx, cls)
{
	var t, d;
	if (document.getElementById)
		t = document.getElementById(tbl);
	else
		t = document.all(tbl);
	if (t == null) return;
	if (t.getElementsByTagName)
		d = t.getElementsByTagName("TD");
	else
		d = t.all.tags("TD");
	if (d == null) return;
	if (d.length <= idx) return;
	d[idx].className = cls;
}


function popcalendar(id)
{
    var oElem = event.srcElement;
    fieldname=id;

   /*  alert(oElem.parentElement.offsetLeft);
     alert(oElem.parentElement.offsetTop); */
     URL = '../html/calendar.html';
     opts ="width=210px,height=185px,top="+(event.clientY+170)+ ",left="+event.clientX ;
 //showMeDialog("admin_select.php?sId=[$sId]&o=psn&psn=" + psn,"color","dialogWidth:428px;dialogHeight:266px;help:0;status:0;scroll:no");
     if (popupWin==null)
       {popupWin=window.open( URL,"calendar", opts);}
     if (popupWin.closed)
       {popupWin=window.open( URL,"calendar", opts);}
   else {
  	 popupWin.close();
  	 popupWin=window.open( URL,"calendar", opts);
   }
}
</script>
<SCRIPT>
var elo;
var loadmenuok=false;
var type = 'main';
var cId = '[$cInfo.cId]';
function initrightmenu(){
	loadmenuok = true;
}



function going(action, pId) {
	switch(action) {
		case 'viewpublish':
			eval('var mPath = mPath_' + pId + '.href');
			window.open(mPath,"","")

			break;
		default:
			document.location = '[$base_url]' + 'o=' + action + '&type=' + type + '&pId=' + pId + '&cId=' + cId + '&referer=' + document.location;

	}
	//sId=6891856b84ee23f2330ee8359cd3f60d&o=view&type=main&pId=41&cId=4
}


</SCRIPT>

<SCRIPT language=JavaScript>
<!--
function gogo(url)
{
	top.panelWork.location = url;
}

function CheckAll(form)  {
  for (var i=0;i<form.elements.length;i++)    {
    var e = form.elements[i];
    if (e.name != 'chkall' && e.name !='copy')       e.checked = form.chkall.checked; 
   }
  }

//-->
var NodeID = '[$NodeInfo.NodeID]'
function doing(action,param)
{
	switch(action) {
		case 'createContent':
			createContent();
			break;
		case 'syncContent':
			parent.mainFrame.location = "admin_publish.php?sId=[$sId]&o=node_resync&type=main&NodeID=" +NodeID

			break;
		case 'resource_admin':
			parent.mainFrame.location = "admin_resource.php?sId=[$sId]&o=admin_frameset&&NodeID=" +NodeID
			break;
		case 'extrapublish_admin':
			parent.mainFrame.location = "admin_extrapublish.php?sId=[$sId]&o=list&NodeID=" +NodeID
			break;
		case 'contribution':
			parent.mainFrame.location = "admin_contribution.php?sId=[$sId]&o=content_list&NodeID=" +NodeID
			break;
 		case 'setting':
			var url = urlencode(parent.mainFrame.location);
			parent.mainFrame.location = "admin_site.php?sId=[$sId]&o=edit&NodeID=" +NodeID + "&referer=" + url;
			break;
		case 'advanced_search':
			parent.mainFrame.location = "admin_publish.php?sId=[$sId]&o=content_list&type=main&NodeID=" +NodeID + "&State=" + param
			break;
		case 'view_index':
			window.open("admin_extrapublish.php?sId=[$sId]&o=viewIndex&NodeID=" +NodeID,'')
			break;
		case 'edit_index':
			var IndexTplTID = '[$NodeInfo.IndexTplTID]';
			if(IndexTplTID != '') {
				var url = urlencode(parent.mainFrame.location);
				parent.mainFrame.location = "admin_cate_tpl.php?sId=[$sId]&o=edit&TID=[$NodeInfo.IndexTplTID]&TCID=[$NodeInfo.IndexTplTCID]&referer=" + url;
			} else {
				var leftPos = (screen.availWidth-800) / 2
				var topPos = (screen.availHeight-600) / 2 
				var popupWin = window.open('admin_tpl.php?sId=[$sId]&o=editor_frameset&extra=edit&PATH=&targetFile=[$NodeInfo.IndexTpl]&NodeID=' + NodeID, '','width=800,height=600,scrollbars=no,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);
			
			}

			break;
		case 'edit_content_tpl':
			var ContentTplTID = '[$NodeInfo.ContentTplTID]';
			if(ContentTplTID != '') {
				var url = urlencode(parent.mainFrame.location);
				parent.mainFrame.location = "admin_cate_tpl.php?sId=[$sId]&o=edit&TID=[$NodeInfo.ContentTplTID]&TCID=[$NodeInfo.ContentTplTCID]&referer=" + url;
			} else {
				var IndexID = prompt('{lang:input_indexid}', '');
				var leftPos = (screen.availWidth-800) / 2
				var topPos = (screen.availHeight-600) / 2 
				var popupWin = window.open('admin_tpl.php?sId=[$sId]&o=editor_frameset&extra=edit&PATH=&targetFile=[$NodeInfo.ContentTpl]&IndexID=' + IndexID, '','width=800,height=600,scrollbars=no,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);
			}
			break;
		case 'edit_image_tpl':
			var ImageTplTID = '[$NodeInfo.ImageTplTID]';
			if(ImageTplTID != '') {
				var url = urlencode(parent.mainFrame.location);
				parent.mainFrame.location = "admin_cate_tpl.php?sId=[$sId]&o=edit&TID=[$NodeInfo.ImageTplTID]&TCID=[$NodeInfo.ImageTplTCID]&referer=" + url;
			} else {	
				var leftPos = (screen.availWidth-800) / 2
				var topPos = (screen.availHeight-600) / 2 
				var popupWin = window.open('admin_tpl.php?sId=[$sId]&o=editor_frameset&extra=edit&PATH=&targetFile=[$NodeInfo.ImageTpl]', '','width=800,height=600,scrollbars=no,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);

			}
			
			break;
		case 'refresh_index':
			top.CrawlerTaskFrame.addThread("admin_task.php?sId=[$sId]&o=refreshIndex&mode=running&TaskID=refreshIndex"+ NodeID +"&NodeID=" + NodeID, "refreshIndex"+ NodeID);
			//window.open("admin_extrapublish.php?sId=[$sId]&o=refreshIndex&NodeID=" +NodeID,'')
			break;
		case 'refresh_view':
			parent.mainFrame.location = parent.mainFrame.location;
			break;
		case 'deploy':
			parent.mainFrame.location = "admin_publish.php?sId=[$sId]&o=deploy&type=main&NodeID=" +NodeID
			break;
		case 'recycle_bin':
			parent.mainFrame.location = "admin_publish.php?sId=[$sId]&o=recycle_bin&type=main&NodeID=" +NodeID
			break;
		default:
			parent.mainFrame.location = "admin_publish.php?sId=[$sId]&o=content_list&type=main&NodeID=" +NodeID
			break;

		
	}
}
function addThread(url,TaskID) {
	top.CrawlerTaskFrame.addThread(url , TaskID)
	
}
function createContent()
{
	var leftPos = (screen.availWidth-800) / 2
	var topPos = (screen.availHeight-600) / 2 
	var popupWin = window.open('admin_publish.php?sId=[$sId]&type=main&o=content_editor_frameset&extra=add&NodeID='+NodeID ,'editor','width=800,height=600,scrollbars=no,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);
}

function refreshWorkArea()
{
 parent.mainFrame.location =  parent.mainFrame.location
}
</script>
<script>
var mousemovecolor="#D4D4D4";
var selectcolor ="#DDDDDD";
var oldcolor;

function GetRow(oElem)
{
	while (oElem)
	{	//alert(oElem.tagName.toLowerCase())
		if (oElem.tagName.toLowerCase() == "tr" || oElem.parentElement.tagName.toLowerCase() == "tbody") 
		    return oElem;
		if (oElem.tagName.toLowerCase() == "table" || oElem.tagName.toLowerCase() == "th") return false;
		oElem = oElem.parentElement;
	}
}


function selected()
{	//alert(pid)

	var trstyle = GetRow( window.event.srcElement );
	var a;
	if( !trstyle )
		return false;

	if( trstyle.style.backgroundColor.toLowerCase() == selectcolor.toLowerCase())
	{
		trstyle.style.backgroundColor = "";
		a=eval("p_"+ trstyle.id);	
		//alert(trstyle.id)
		if (a!=null || a.checked) 
			a.checked=false
		oldcolor = "";
	}
	else
	{		
		trstyle.style.backgroundColor = selectcolor;
		a=eval("p_"+ trstyle.id);
		//alert(trstyle.id)
		if (a!=null) 
			a.checked=true
		oldcolor = selectcolor;

	
	}
}
</script>
<script language="javascript">
lastDiv = null;
/*
.lt0
{
	border: solid 1px #F1F1F1;
	background: #F1F1F1;
	padding: 0px 6px 0px 6px;
	font-size: 11px; font-family: Tahoma, Arial;
	cursor: hand;
}

.lt1
{
	border: solid 1px #999;
	background: #CCC;
	padding: 0px 6px 0px 6px;
	cursor: hand;
}
*/
function highLight(theDiv) {
	if (lastDiv) {
		lastDiv.style.border = 'solid 1px #F1F1F1';
		lastDiv.style.background = '#F1F1F1';
	}
	//alert(theDiv);
	lastDiv = theDiv;
	theDiv.style.border = ' solid 1px #999';
	theDiv.style.background = '#CCC';
	

}

</script>	
<div id="menudata"></div>
<div id="msviLocalToolbar">
  <table cellpadding="0" cellspacing="2" width="100%" height="19" border="0">
    <tr> 
      <td class="lt0" height="18" nowrap="nowrap"   >
	  <font id=large>
	  <if $NodeInfo.NodeType == 2> 
	  [$NodeInfo.Name](<a href="javascript:gogo('admin_publish.php?sId=[$sId]&o=list&type=main&NodeID=[$NodeInfo.InheritNodeID]')" >[$NodeInfo.ParentNodeName]</a>)
	  <else>
	  [$NodeInfo.Name]
	  </if>
	  </font> 
	  <font id=description>[<B>[$NodeInfo.NodeID]</B>]</font></td>
      <td></td>
<if $NodeInfo.NodeType == 1>
      <td class="lt0" nowrap="nowrap" onmouseover="mhHover('msviLocalToolbar', 2, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 2, 'lt0')" onclick="doing('createContent');highLight(this);">{lang:add_doc}</td>

<elseif $NodeInfo.NodeType == 2>
      <td class="lt0" nowrap="nowrap" onmouseover="mhHover('msviLocalToolbar', 2, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 2, 'lt0')" onclick="doing('syncContent');highLight(this);">{lang:sync_doc}</td>

<elseif $NodeInfo.NodeType == 3>
      <td class="lt0" nowrap="nowrap" onmouseover="mhHover('msviLocalToolbar', 2, 'lt1')" onmouseout="mhHover('msviLocalToolbar', 2, 'lt0')" onclick="doing('createContent');highLight(this);">{lang:add_doc}</td>

</if>


       <td><span class="ltsep">|</span></td>
<?php $Counter = 4;?>

      <td class="lt0" nowrap="nowrap" onmouseover="mhHover('msviLocalToolbar', <?=$Counter?>, 'lt1')" onmouseout="mhHover('msviLocalToolbar', <?=$Counter?>, 'lt0')" onclick="doing('');highLight(this);">{lang:publish_admin}</td>
  
<?php $Counter = $Counter + 2;?> 
     <td><span class="ltsep">|</span></td>   
    <td class="lt0" nowrap="nowrap" onmouseover="mhHover('msviLocalToolbar', <?=$Counter?>, 'lt1')" onmouseout="mhHover('msviLocalToolbar', <?=$Counter?>, 'lt0')" onclick="doing('setting');highLight(this);">{lang:setting}</td>

 

	    <?php $Counter = $Counter + 2;?> 
<if  $NodeInfo.NodeType != 2 >
	   <td><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap" onmouseover="mhHover('msviLocalToolbar', <?=$Counter?>, 'lt1')" onmouseout="mhHover('msviLocalToolbar', <?=$Counter?>, 'lt0')" onclick="doing('recycle_bin');highLight(this);">{lang:recycle_bin}</td>
</if>



 <if $NodeInfo.IndexTpl != '' && $NodeInfo.PublishMode !=0>
 <?php $Counter = $Counter + 2;?> 

     <td ><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap"><A HREF="javascript:doing('view_index');"  >{lang:view_index}</A>&nbsp;/&nbsp;<A HREF="javascript:doing('edit_index');"  >{lang:edit_index}</A>&nbsp;/&nbsp;<A HREF="javascript:doing('refresh_index');"   >{lang:refresh_index}</A></td>
 
      
</if>

 <if $NodeInfo.ContentTpl != '' && $NodeInfo.PublishMode !=0>
 <?php $Counter = $Counter + 2;?> 

     <td ><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap">{lang:edit_index}<A HREF="javascript:doing('edit_content_tpl');"  >{lang:edit_content_tpl}</A>&nbsp;/&nbsp;<A HREF="javascript:doing('edit_image_tpl');"  >{lang:edit_image_tpl}</A>{lang:tpl}</td>
 
      
</if>

     <td>&nbsp;</td>
      <td width="100%"></td>
    </tr>
  </table>
</div>

</body></html>