<?php include("../sysdata/templates_c/%%c_^@skin@admin@header_init.html");?>
<link rel="stylesheet" href="../html/calendar.css" type="text/css">
<BODY  style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" >
<style>

div.titleholder {
	font-family: ms sans serif, arial;
	font-size: 8pt;
	width: 300;
	text-overflow: ellipsis;
	margin: 0px;
	overflow: hidden;
	white-space: nowrap;			
}		
div.subtitleholder {
	font-family: ms sans serif, arial;
	font-size: 8pt;
	
	text-overflow: ellipsis;
	margin: 0px;
	overflow: hidden;
	white-space: nowrap;			
}
div.timeholder {
	font-family: ms sans serif, arial;
	font-size: 8pt;
	width: 90;
	text-overflow: ellipsis;
	margin: 0px;
	overflow: hidden;
	white-space: nowrap;			
}	
.table_plan_td1 {
	background-color: #FDEEB9
}
</style>
<script language='JavaScript'>

function refreshWorkArea()
{
 document.location =  document.location
}

var doImage = doImage;
var TType = TType;

function mhHover(tbl, idx, cls)
{
	var t, d;
	if (document.getElementById)
		t = document.getElementById(tbl);
	else
		t = document.all(tbl);
	if (t == null) return;
	if (t.getElementsByTagName)
		d = t.getElementsByTagName("TD");
	else
		d = t.all.tags("TD");
	if (d == null) return;
	if (d.length <= idx) return;
	d[idx].className = cls;
}

</script>
<script type="text/javascript" src="../html/calendar.js"></script>
<script type="text/javascript">
Calendar._DN = new Array
("<?echo $_LANG_SKIN['Sunday']; ?>",
 "<?echo $_LANG_SKIN['Monday']; ?>",
 "<?echo $_LANG_SKIN['Tuesday']; ?>",
 "<?echo $_LANG_SKIN['Wednesday']; ?>",
 "<?echo $_LANG_SKIN['Thursday']; ?>",
 "<?echo $_LANG_SKIN['Friday']; ?>",
 "<?echo $_LANG_SKIN['Saturday']; ?>",
 "<?echo $_LANG_SKIN['Sunday']; ?>");
Calendar._MN = new Array
("<?echo $_LANG_SKIN['January']; ?>",
 "<?echo $_LANG_SKIN['February']; ?>",
 "<?echo $_LANG_SKIN['March']; ?>",
 "<?echo $_LANG_SKIN['April']; ?>",
 "<?echo $_LANG_SKIN['May']; ?>",
 "<?echo $_LANG_SKIN['June']; ?>",
 "<?echo $_LANG_SKIN['July']; ?>",
 "<?echo $_LANG_SKIN['August']; ?>",
 "<?echo $_LANG_SKIN['September']; ?>",
 "<?echo $_LANG_SKIN['October']; ?>",
 "<?echo $_LANG_SKIN['November']; ?>",
 "<?echo $_LANG_SKIN['December']; ?>");

Calendar._TT = {};
Calendar._TT["TOGGLE"] = "Toggle first day of week";
Calendar._TT["PREV_YEAR"] = "<?echo $_LANG_SKIN['Last_year']; ?>  ";
Calendar._TT["PREV_MONTH"] = "<?echo $_LANG_SKIN['Last_month']; ?>  ";
Calendar._TT["GO_TODAY"] = "<?echo $_LANG_SKIN['Today']; ?>";
Calendar._TT["NEXT_MONTH"] = "<?echo $_LANG_SKIN['Next_month']; ?>  ";
Calendar._TT["NEXT_YEAR"] = "<?echo $_LANG_SKIN['Next_year']; ?>  ";
Calendar._TT["SEL_DATE"] = "<?echo $_LANG_SKIN['select_date']; ?>";
Calendar._TT["DRAG_TO_MOVE"] = "Drag to move";
Calendar._TT["PART_TODAY"] = " <?echo $_LANG_SKIN['Today1']; ?>";
Calendar._TT["MON_FIRST"] = "Display Monday first";
Calendar._TT["SUN_FIRST"] = "Display Sunday first";
Calendar._TT["CLOSE"] = "<?echo $_LANG_SKIN_GLOBAL['close']; ?>";
Calendar._TT["TODAY"] = "<?echo $_LANG_SKIN['Today']; ?>";
</script>
<script type="text/javascript">

var calendar = null; // remember the calendar object so that we reuse it and
                     // avoid creation other calendars.

// code from http://www.meyerweb.com -- change the active stylesheet.
function setActiveStyleSheet(title) {
  var i, a, main;
  for(i=0; (a = document.getElementsByTagName("link")[i]); i++) {
    if(a.getAttribute("rel").indexOf("style") != -1 && a.getAttribute("title")) {
      a.disabled = true;
      if(a.getAttribute("title") == title) a.disabled = false;
    }
  }
  document.getElementById("style").innerHTML = title;
  return false;
}

// This function gets called when the end-user clicks on some date.
function selected(cal, date) {
  cal.sel.value = date; // just update the date in the input field.
  if (cal.sel.id == "sel1" || cal.sel.id == "sel3" || cal.sel.id == "sel5" || cal.sel.id == "sel7")
    // if we add this call we close the calendar on single-click.
    // just to exemplify both cases, we are using this only for the 1st
    // and the 3rd field, while 2nd and 4th will still require double-click.
    cal.callCloseHandler();
}

// And this gets called when the end-user clicks on the _selected_ date,
// or clicks on the "Close" button.  It just hides the calendar without
// destroying it.
function closeHandler(cal) {
  cal.hide();                        // hide the calendar

  // don't check mousedown on document anymore (used to be able to hide the
  // calendar when someone clicks outside it, see the showCalendar function).
  Calendar.removeEvent(document, "mousedown", checkCalendar);
}

// This gets called when the user presses a mouse button anywhere in the
// document, if the calendar is shown.  If the click was outside the open
// calendar this function closes it.
function checkCalendar(ev) {
  var el = Calendar.is_ie ? Calendar.getElement(ev) : Calendar.getTargetElement(ev);
  for (; el != null; el = el.parentNode)
    // FIXME: allow end-user to click some link without closing the
    // calendar.  Good to see real-time stylesheet change :)
    if (el == calendar.element || el.tagName == "A") break;
  if (el == null) {
    // calls closeHandler which should hide the calendar.
    calendar.callCloseHandler();
    Calendar.stopEvent(ev);
  }
}

// This function shows the calendar under the element having the given id.
// It takes care of catching "mousedown" signals on document and hiding the
// calendar if the click was outside.
function showCalendar(id, format) {
  var el = document.getElementById(id);
  if (calendar != null) {
    // we already have some calendar created
    calendar.hide();                 // so we hide it first.
  } else {
    // first-time call, create the calendar.
    var cal = new Calendar(true, null, selected, closeHandler);
    calendar = cal;                  // remember it in the global var
    cal.setRange(1900, 2070);        // min/max year allowed.
    cal.create();
  }
  calendar.setDateFormat(format);    // set the specified date format
  calendar.parseDate(el.value);      // try to parse the text in field
  calendar.sel = el;                 // inform it what input field we use
  calendar.showAtElement(el);        // show the calendar below it

  // catch "mousedown" on document
  Calendar.addEvent(document, "mousedown", checkCalendar);
  return false;
}

var MINUTE = 60 * 1000;
var HOUR = 60 * MINUTE;
var DAY = 24 * HOUR;
var WEEK = 7 * DAY;

// If this handler returns true then the "date" given as
// parameter will be disabled.  In this example we enable
// only days within a range of 10 days from the current
// date.
// You can use the functions date.getFullYear() -- returns the year
// as 4 digit number, date.getMonth() -- returns the month as 0..11,
// and date.getDate() -- returns the date of the month as 1..31, to
// make heavy calculations here.  However, beware that this function
// should be very fast, as it is called for each day in a month when
// the calendar is (re)constructed.
function isDisabled(date) {
  var today = new Date();
  return (Math.abs(date.getTime() - today.getTime()) / DAY) > 10;
}

function flatSelected(cal, date) {
  var el = document.getElementById("preview");
  el.innerHTML = date;
}

function showFlatCalendar() {
  var parent = document.getElementById("display");

  // construct a calendar giving only the "selected" handler.
  var cal = new Calendar(true, null, flatSelected);

  // We want some dates to be disabled; see function isDisabled above
  cal.setDisabledHandler(isDisabled);
  cal.setDateFormat("DD, M d");

  // this call must be the last as it might use data initialized above; if
  // we specify a parent, as opposite to the "showCalendar" function above,
  // then we create a flat calendar -- not popup.  Hidden, though, but...
  cal.create(parent);

  // ... we can show it here.
  cal.show();
}
</script>
<SCRIPT>
var elo;
var loadmenuok=false;
var type = 'main';
var NodeID = '<?php echo $this->_tpl_vars["NodeInfo"]["NodeID"];?>';
var TableID = '<?php echo $this->_tpl_vars["NodeInfo"]["TableID"];?>';
function initrightmenu(){
	loadmenuok = true;
}




function addThread(url,TaskID) {
	top.CrawlerTaskFrame.addThread(url , TaskID)
	
}

function doing(action, IndexID) {
	var returnValue;
	switch(action) {
 
		case 'note':
			var leftPos = (screen.availWidth-800) / 2
			var topPos = (screen.availHeight-600) / 2 
			 window.open('admin_contribution.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=viewNote&NodeID='+NodeID  + '&ContributionID=' + IndexID,'','width=400,height=300,scrollbars=yes,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);

			break;
		case 'advanced_search':
			parent.mainFrame.location = "admin_publish.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=content_list&type=main&NodeID=" +NodeID + "&State=" + IndexID
			break;

		case 'viewLinkState':
			var leftPos = (screen.availWidth-800) / 2
			var topPos = (screen.availHeight-600) / 2 
			 window.open('<?php echo $this->_tpl_vars["base_url"];?>o='+ action +'&IndexID='+ IndexID  + '&NodeID=' + NodeID,'','width=400,height=300,scrollbars=yes,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);
			 break;
		case 'topIt':
			var hello = showMeDialog("<?php echo $this->_tpl_vars["base_url"];?>o=topIt&IndexID=" + IndexID + '&NodeID=' + NodeID,"color","dialogWidth:324px;dialogHeight:150px;help:0;status:0;scroll:no");
			

			if(hello != null && hello != '') {
				returnValue = CMSware_send('<?php echo $this->_tpl_vars["base_url"];?>' + 'o=topIt_submit&Weight='+ hello + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID);
				if(returnValue == '1') {
					alert("<?php echo $_LANG_SKIN['topit_ok'];?>");
					document.location.reload();
					return true;
					
				} else {
					alert("<?php echo $_LANG_SKIN['topit_fail'];?>");
					document.location.reload();
					return false;
				
				}			
			}

			break;
		case 'pinkIt':
			var hello = showMeDialog("<?php echo $this->_tpl_vars["base_url"];?>o=pinkIt&IndexID=" + IndexID + '&NodeID=' + NodeID,"color","dialogWidth:324px;dialogHeight:150px;help:0;status:0;scroll:no");
			

			if(hello != null && hello != '') {
				returnValue = CMSware_send('<?php echo $this->_tpl_vars["base_url"];?>' + 'o=pinkIt_submit&Weight='+ hello + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID);
				//alert(hello);
				if(returnValue == '1') {
					alert("<?php echo $_LANG_SKIN['pinkit_ok'];?>");
					document.location.reload();
					return true;
					
				} else {
					alert("<?php echo $_LANG_SKIN['pinkit_fail'];?>");
					document.location.reload();
					return false;
				
				}

			}

			break;

		case 'sortIt':
			var hello = showMeDialog("<?php echo $this->_tpl_vars["base_url"];?>o=sortIt&IndexID=" + IndexID + '&NodeID=' + NodeID,"color","dialogWidth:324px;dialogHeight:150px;help:0;status:0;scroll:no");
			

			if(hello != null && hello != '') {
				returnValue = CMSware_send('<?php echo $this->_tpl_vars["base_url"];?>' + 'o=sortIt_submit&Weight='+ hello + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID);
				//alert(hello);
				if(returnValue == '1') {
					alert("<?php echo $_LANG_SKIN['sort_ok'];?>");
					document.location.reload();
					return true;
					
				} else {
					alert("<?php echo $_LANG_SKIN['sort_fail'];?>");
					document.location.reload();
					return false;
				
				}

			}

			break;

		case 'viewpublish':
			eval('var mPath = URL_' + IndexID + '.href');
			window.open(mPath,"","")

			break;
		case 'getURL':
			eval('var mPath = URL_' + IndexID + '.href');
			prompt("<?php echo $_LANG_SKIN['doc_publish_url'];?>",mPath);
			break;
		case 'copyURL':
			eval('var mPath = URL_' + IndexID + '.href');
			window.clipboardData.setData('Text', mPath);
			break;
		case 'edit':
			var leftPos = (screen.availWidth-800) / 2
			var topPos = (screen.availHeight-600) / 2 
			 window.open('<?php echo $this->_tpl_vars["base_url"];?>type=main&o=content_editor_frameset&extra=edit&NodeID='+NodeID  + '&IndexID=' + IndexID,'','width=800,height=600,scrollbars=no,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);

			break;
		case 'del':
			if(confirm("<?php echo $_LANG_SKIN_GLOBAL['confirm_del'];?>")) {
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID  ;
				document.documentlist.submit();
				
			}
			break;
		case 'view':
			var leftPos = (screen.availWidth-800) / 2
			var topPos = (screen.availHeight-600) / 2 
			 window.open('<?php echo $this->_tpl_vars["base_url"];?>type=main&o=view&NodeID='+NodeID  + '&IndexID=' + IndexID,'','width=800,height=600,scrollbars=yes,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);

			break;
		case 'cut':
			var targetNodeID = showMeDialog("admin_select.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=targetNodeWindow","color","dialogWidth:324px;dialogHeight:331px;help:0;status:0;scroll:no");
			
			if(targetNodeID != null && targetNodeID != '') {
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID + '&targetNodeID=' + targetNodeID  ;
				document.documentlist.submit();
			
			}

			break;
		case 'copy':
			var targetNodeID = showMeDialog("admin_select.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=targetNodeWindow","color","dialogWidth:324px;dialogHeight:331px;help:0;status:0;scroll:no");
			
			if(targetNodeID != null && targetNodeID != '') {
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID + '&targetNodeID=' + targetNodeID  ;
				document.documentlist.submit();
			
			}

			break;
		case 'createLink':
			
			var targetNodeID = showMeDialog("admin_select.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=targetNodeWindow","color","dialogWidth:324px;dialogHeight:331px;help:0;status:0;scroll:no");
			
			if(targetNodeID != null && targetNodeID != '') {
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID + '&targetNodeID=' + targetNodeID  ;
				document.documentlist.submit();
				//alert(IndexID + '-' + targetNodeID)
			}
			break;
		case 'createIndexLink':
			var targetNodeID = showMeDialog("admin_select.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=targetNodeWindow","color","dialogWidth:324px;dialogHeight:331px;help:0;status:0;scroll:no");
			
			if(targetNodeID != null && targetNodeID != '') {
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID + '&targetNodeID=' + targetNodeID  ;
				document.documentlist.submit();
				//alert(IndexID + '-' + targetNodeID)
			}
			break;			
		case 'publish':
			document.documentlist.referer.value = document.location;
			document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID + '&targetNodeID=' + targetNodeID  ;
			document.documentlist.submit();
				//alert(IndexID + '-' + targetNodeID)
		
			break;
		case 'unpublish':
			if(confirm("<?php echo $_LANG_SKIN['confirm_unpublish'];?>")) {
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID + '&targetNodeID=' + targetNodeID  ;
				document.documentlist.submit();
				//alert(IndexID + '-' + targetNodeID)
			}
			break;
		case 'tempUnPublish':
 				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID + '&targetNodeID=' + targetNodeID  ;
				document.documentlist.submit();
				//alert(IndexID + '-' + targetNodeID)
 			break;
		case 'refresh':
			document.documentlist.referer.value = document.location;
			document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + action + '&type=' + type + '&IndexID=' + IndexID + '&NodeID=' + NodeID + '&targetNodeID=' + targetNodeID  ;
			document.documentlist.submit();
			break;
		case 'display_record':
			parent.mainFrame.location = "admin_publish.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=content_list&type=main&NodeID=" + NodeID + "&offset=" + document.documentlist.offset.value;
			break;
		case 'date_search':
			var DateString = document.getElementById('dTime');
			document.location = "admin_search.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=search&Tpl=content_admin_search.html&TableID="+ TableID +"&NodeID=" + NodeID + "&offset=" + document.documentlist.offset.value + "&Date=" + DateString.value;
			//alert(document.location);
			break;
		case 'keyword_search':
			var KeywordsString = document.getElementById('SearchKeywords');
			document.location = "admin_search.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=search&Tpl=content_admin_search.html&TableID="+ TableID +"&NodeID=" + NodeID + "&offset=" + document.documentlist.offset.value + "&Field=all&Keywords=" + KeywordsString.value ;
			break;
		case 'search_pro':
			var KeywordsString = document.getElementById('SearchKeywords');
			parent.document.location = "admin_search.php?sId=<?php echo $this->_tpl_vars["sId"];?>&Tpl=content_admin_search.html&TableID="+ TableID +"&NodeID=" + NodeID + "&offset=" + document.documentlist.offset.value + "&Field=all&Keywords=" + KeywordsString.value ;
			break;
		default:
			document.location = document.location;

	}
	//sId=6891856b84ee23f2330ee8359cd3f60d&o=view&type=main&pId=41&cId=4
}



function rightMenu(pId, State, Type, Top,Pink, ContributionID) {
	var toolMenu = new WebFXMenu;


	if(Type == '1') {
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['view'];?>','javascript:doing("view","'+ pId +'")','<?php echo $_LANG_SKIN['view_doc'];?>'));

		if(ContributionID != '0') {
			toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['view_note'];?>','javascript:doing("note","'+ ContributionID +'")','<?php echo $_LANG_SKIN['view_note'];?>'));		
		}
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['edit'];?>','javascript:doing("edit","'+ pId +'")','<?php echo $_LANG_SKIN['edit_doc'];?>'));
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['del'];?>','javascript:doing("del","'+ pId +'")', '<?php echo $_LANG_SKIN['del_doc'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['cut'];?>','javascript:doing("cut","'+ pId +'")', '<?php echo $_LANG_SKIN['cut_doc'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['copy'];?>','javascript:doing("copy","'+ pId +'")', '<?php echo $_LANG_SKIN['copy_doc'];?>'));
		<?php if($this->_tpl_vars["NodeInfo"]["PublishMode"] != 0 ): ?>
		toolMenu.add(new WebFXMenuSeparator());
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['create_link'];?>','javascript:doing("createLink","'+ pId +'")', '<?php echo $_LANG_SKIN['create_link'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['create_index_link'];?>','javascript:doing("createIndexLink","'+ pId +'")', '<?php echo $_LANG_SKIN['create_index_link'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['view_link_state'];?>','javascript:doing("viewLinkState","'+ pId +'")', '<?php echo $_LANG_SKIN['view_link_state'];?>'));
		<?php endif;?>
	} else {
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['view'];?>','javascript:doing("view","'+ pId +'")','<?php echo $_LANG_SKIN['view_doc'];?>'));
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['del'];?>','javascript:doing("del","'+ pId +'")', '<?php echo $_LANG_SKIN['del_doc'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['cut'];?>','javascript:doing("cut","'+ pId +'")', '<?php echo $_LANG_SKIN['cut_doc'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN_GLOBAL['copy'];?>','javascript:doing("copy","'+ pId +'")', '<?php echo $_LANG_SKIN['copy_doc'];?>'));
		<?php if($this->_tpl_vars["NodeInfo"]["PublishMode"] != 0 ): ?>
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['view_link_state'];?>','javascript:doing("viewLinkState","'+ pId +'")', '<?php echo $_LANG_SKIN['view_link_state'];?>'));
		<?php endif;?>
	
	
	}

	toolMenu.add(new WebFXMenuSeparator());
	
	toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['topit'];?>','javascript:doing("topIt","'+ pId +'")','<?php echo $_LANG_SKIN['topit'];?>'));

	toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['pinkit'];?>','javascript:doing("pinkIt","'+ pId +'")','<?php echo $_LANG_SKIN['pinkit'];?>'));
	toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['sortit'];?>','javascript:doing("sortIt","'+ pId +'")','<?php echo $_LANG_SKIN['sortit'];?>'));
	


	<?php if($this->_tpl_vars["NodeInfo"]["PublishMode"] != 0 ): ?>

	if(State == 0 ) {
		toolMenu.add(new WebFXMenuSeparator());
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['publish'];?>','javascript:doing("publish","'+ pId +'")','<?php echo $_LANG_SKIN['publish_doc'];?>'));
	
	} else if(State == 1 ) {
		toolMenu.add(new WebFXMenuSeparator());
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['view_publish'];?>','javascript:doing("viewpublish","'+ pId +'")','<?php echo $_LANG_SKIN['view_publish'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['copy_url'];?>','javascript:doing("copyURL","'+ pId +'")','<?php echo $_LANG_SKIN['copy_url'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['get_url'];?>','javascript:doing("getURL","'+ pId +'")','<?php echo $_LANG_SKIN['get_url'];?>'));
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['refresh_publish'];?>','javascript:doing("refresh","'+ pId +'")','<?php echo $_LANG_SKIN['refresh_publish'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['unpublish'];?>','javascript:doing("unpublish","'+ pId +'")','<?php echo $_LANG_SKIN['unpublish'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['tempUnPublish'];?>','javascript:doing("tempUnPublish","'+ pId +'")','<?php echo $_LANG_SKIN['tempUnPublish'];?>'));
	
	} else if (State == 1 && Type==2) {
		toolMenu.add(new WebFXMenuSeparator());
		//toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['view_publish'];?>','javascript:doing("viewpublish","'+ pId +'")','<?php echo $_LANG_SKIN['view_publish'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['copy_url'];?>','javascript:doing("copyURL","'+ pId +'")','<?php echo $_LANG_SKIN['copy_url'];?>'));
		toolMenu.add(new WebFXMenuItem('<?php echo $_LANG_SKIN['get_url'];?>','javascript:doing("getURL","'+ pId +'")','<?php echo $_LANG_SKIN['get_url'];?>'));
	
	}
	<?php endif;?>

	menudata.innerHTML = toolMenu 

	elo=window.event.srcElement;
	toolMenu.left = window.event.clientX;
	toolMenu.top = window.event.clientY+document.body.scrollTop;
	toolMenu.show();

	//initrightmenu();

}
</SCRIPT>

<SCRIPT language=JavaScript>
<!--
function CheckAll(form)  {
  for (var i=0;i<form.elements.length;i++)    {
    var e = form.elements[i];
    if (e.name != 'chkall' && e.name !='copy')       e.checked = form.chkall.checked; 
   }
  }

//-->


</script>
<script>
var mousemovecolor="#D4D4D4";
var selectcolor ="#DDDDDD";
var oldcolor;

function GetRow(oElem)
{
	while (oElem)
	{	//alert(oElem.tagName.toLowerCase())
		if (oElem.tagName.toLowerCase() == "tr" || oElem.parentElement.tagName.toLowerCase() == "tbody") 
		    return oElem;
		if (oElem.tagName.toLowerCase() == "table" || oElem.tagName.toLowerCase() == "th") return false;
		oElem = oElem.parentElement;
	}
}

/*
function selected()
{	//alert(pid)

	var trstyle = GetRow( window.event.srcElement );
	var a;
	if( !trstyle )
		return false;

	if( trstyle.style.backgroundColor.toLowerCase() == selectcolor.toLowerCase())
	{
		trstyle.style.backgroundColor = "";
		a=eval("p_"+ trstyle.id);	
		//alert(trstyle.id)
		if (a!=null || a.checked) 
			a.checked=false
		oldcolor = "";
	}
	else
	{		
		trstyle.style.backgroundColor = selectcolor;
		a=eval("p_"+ trstyle.id);
		//alert(trstyle.id)
		if (a!=null) 
			a.checked=true
		oldcolor = selectcolor;

	
	}
}
*/
function going(form, o)
{
	document.documentlist.referer.value = document.location;
	
	var selected = 0 ; 

	for (var i=0;i<form.elements.length;i++)    {
	    var e = form.elements[i];
	    if(e.type != 'checkbox')	continue;
	   
	   if(e.checked) {
			if(e.name == 'pData[]') {
				 selected = 1;
				 break;
			} else {
				continue;
			}
 
	   } else {
	   		continue;
	   }
	}

	if(selected == 0) {
		alert("<?php echo $_LANG_SKIN['please_select_content_todo'];?>");
		return false;
	}

	with(form) {
		switch(o) {
			case 'all_unpublish':
				document.documentlist.referer.value = document.location;
				document.documentlist.action = "admin_task.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=rePublishContent_unpublish&type=nopublish&unpublishmode=1&NodeID=" + NodeID;
				document.documentlist.submit();
				break;
			case 'all_tempUnpublish':
				
				document.documentlist.referer.value = document.location;
				document.documentlist.action = "admin_task.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=rePublishContent_unpublish&type=nopublish&unpublishmode=0&NodeID=" + NodeID;
				document.documentlist.submit();
				break;
			case 'all_republish':
				document.documentlist.referer.value = document.location;
				document.documentlist.action = "admin_task.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=rePublishContent_unpublish&NodeID=" + NodeID;
				document.documentlist.submit();
				break;
			case 'planPublish':
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + '&multi=1&o=' + o + '&type=' + type +  '&NodeID=' + NodeID  ;
				document.documentlist.submit();
				break;
			case 'refresh':
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + '&multi=1&o=' + o + '&type=' + type +  '&NodeID=' + NodeID  ;
				document.documentlist.submit();
				break;
			case 'publish':
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + '&multi=1&o=' + o + '&type=' + type +  '&NodeID=' + NodeID  ;
				document.documentlist.submit();
				break;
			case 'unpublish':
				if(confirm("<?php echo $_LANG_SKIN['confirm_unpublish'];?>")) {

					document.documentlist.referer.value = document.location;
					document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + '&multi=1&o=' + o + '&type=' + type +  '&NodeID=' + NodeID  ;
					document.documentlist.submit();
				}
				break;
			case 'tempUnPublish':
				document.documentlist.referer.value = document.location;
				document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + '&multi=1&o=' + o + '&type=' + type +  '&NodeID=' + NodeID  ;
				document.documentlist.submit();
 				break;				
			case 'copy':
				var targetNodeID = showMeDialog("admin_select.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=targetNodeWindow","color","dialogWidth:324px;dialogHeight:331px;help:0;status:0;scroll:no");
				
				if(targetNodeID != null && targetNodeID != '') {
					document.documentlist.referer.value = document.location;
					document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + o + '&type=' + type + '&NodeID=' + NodeID + '&multi=1&targetNodeID=' + targetNodeID  ;
					document.documentlist.submit();
					//alert(IndexID + '-' + targetNodeID)
				}

				break;
			case 'cut':
				var targetNodeID = showMeDialog("admin_select.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=targetNodeWindow","color","dialogWidth:324px;dialogHeight:331px;help:0;status:0;scroll:no");
				
				if(targetNodeID != null && targetNodeID != '') {
					document.documentlist.referer.value = document.location;
					document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + o + '&type=' + type + '&NodeID=' + NodeID + '&multi=1&targetNodeID=' + targetNodeID  ;
					document.documentlist.submit();
					//alert(IndexID + '-' + targetNodeID)
				}
				break;
			case 'del':
				if(confirm("<?php echo $_LANG_SKIN['confirm_multi_del'];?>")) {
					action = action + '&o=del&multi=1';
					
					submit();
				}
				break;
			case 'destroy':
				if(confirm("<?php echo $_LANG_SKIN['confirm_multi_destroy'];?>")) {
					action = action + '&o=destroy&multi=1';
					
					submit();
				}
				break;
 
			case 'createLink':
				var targetNodeID = showMeDialog("admin_select.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=targetNodeWindow","color","dialogWidth:324px;dialogHeight:331px;help:0;status:0;scroll:no");
				
				if(targetNodeID != null && targetNodeID != '') {
					document.documentlist.referer.value = document.location;
					document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + o + '&type=' + type + '&NodeID=' + NodeID + '&multi=1&targetNodeID=' + targetNodeID  ;
					document.documentlist.submit();
					//alert(IndexID + '-' + targetNodeID)
				}
				break;
			
			case 'createIndexLink':
				var targetNodeID = showMeDialog("admin_select.php?sId=<?php echo $this->_tpl_vars["sId"];?>&o=targetNodeWindow","color","dialogWidth:324px;dialogHeight:331px;help:0;status:0;scroll:no");
				
				if(targetNodeID != null && targetNodeID != '') {
					document.documentlist.referer.value = document.location;
					document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=' + o + '&type=' + type + '&NodeID=' + NodeID + '&multi=1&targetNodeID=' + targetNodeID  ;
					document.documentlist.submit();
					//alert(IndexID + '-' + targetNodeID)
				}
				break;	
			case 'top':
 				var hello = showMeDialog("<?php echo $this->_tpl_vars["base_url"];?>o=topIt&NodeID=" + NodeID,"color","dialogWidth:324px;dialogHeight:150px;help:0;status:0;scroll:no");
				

				if(hello != null && hello != '') {
					document.documentlist.referer.value = document.location;
					document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=topIt_submit&Weight='+ hello + '&type=' + type + '&NodeID=' + NodeID  ;
					document.documentlist.submit();
				}

				break;
			case 'pink':
 				var hello = showMeDialog("<?php echo $this->_tpl_vars["base_url"];?>o=pinkIt&NodeID=" + NodeID,"color","dialogWidth:324px;dialogHeight:150px;help:0;status:0;scroll:no");
				

				if(hello != null && hello != '') {
					document.documentlist.referer.value = document.location;
					document.documentlist.action = '<?php echo $this->_tpl_vars["base_url"];?>' + 'o=pinkIt_submit&Weight='+ hello + '&type=' + type + '&NodeID=' + NodeID  ;
					document.documentlist.submit();
				}

				break;
			
			
			
			}
	
	}
}
</script>
<div id="menudata"></div>
<div id="msviLocalToolbar">
  <table cellpadding="0" cellspacing="2" width="100%" height="19" border="0">
   <form action="" method="get"> <tr> 
      <td  height="20" nowrap="nowrap" ><?php echo $_LANG_SKIN_GLOBAL['display'];?>:</td>
	<td   height="20" nowrap="nowrap" >
 	<select name="FId" id="select2" onchange="doing('advanced_search', this.options[this.selectedIndex].value)">
		<?php if($this->_tpl_vars["IN"]["State"] === '0' ): ?>
          <option ><?php echo $_LANG_SKIN['all_doc'];?></option>
          <option value="1"><?php echo $_LANG_SKIN['all_published_doc'];?></option>
          <option value="0" selected><?php echo $_LANG_SKIN['all_unpublish_doc'];?></option>
		<?php elseif($this->_tpl_vars["IN"]["State"] == 1 ): ?>
          <option ><?php echo $_LANG_SKIN['all_doc'];?></option>
          <option value="1" selected><?php echo $_LANG_SKIN['all_published_doc'];?></option>
          <option value="0"><?php echo $_LANG_SKIN['all_unpublish_doc'];?></option>
		<?php else: ?>
          <option selected><?php echo $_LANG_SKIN['all_doc'];?></option>
          <option value="1"><?php echo $_LANG_SKIN['all_published_doc'];?></option>
          <option value="0"><?php echo $_LANG_SKIN['all_unpublish_doc'];?></option>
		<?php endif;?>
        </select></td>
      <td height="20" align="right" nowrap="nowrap" ><?php echo $_LANG_SKIN['search_by_date'];?>:</td>
	  <td height="20" align="left" nowrap="nowrap"   > 
        <INPUT TYPE="text" NAME="dTime"   id="dTime" onFocus="return showCalendar('dTime', 'y-mm-dd');" value="<?php echo $this->_tpl_vars["IN"]["Date"];?>" > 
        <INPUT name="Go" TYPE="button" value="<?php echo $_LANG_SKIN_GLOBAL['go'];?>" onclick="doing('date_search')">
      </td>
      <td height="20" align="right" nowrap="nowrap" ><?php echo $_LANG_SKIN['search_by_keyword'];?>: </td>
	  <td   height="20" nowrap="nowrap" > <INPUT TYPE="text" NAME="SearchKeywords" id="SearchKeywords"   value="<?php echo $this->_tpl_vars["IN"]["Keywords"];?>"> 
        <INPUT name="Go" TYPE="button"  value="<?php echo $_LANG_SKIN_GLOBAL['go'];?>" onclick="doing('keyword_search')">

   </td>
   <td> <img src="../html/images/search.gif" border="0" style="cursor:hand"  title="<?php echo $_LANG_SKIN_GLOBAL['search_pro'];?>" onclick="doing('search_pro')"/><span  title="<?php echo $_LANG_SKIN_GLOBAL['search_pro'];?>" onclick="doing('search_pro')" style="cursor:hand"><?php echo $_LANG_SKIN['search_pro'];?></span></td>
   
   
        
   
   </tr></form>
  </table>
</div>

<table width="100%" border="0" align="center" cellpadding="2" cellspacing="1"  class="table_border" >
  <TBODY>
  <form method="post" action="<?php echo $this->_tpl_vars["base_url"];?>type=main&NodeID=<?php echo $this->_tpl_vars["NodeInfo"]["NodeID"];?>" name="documentlist" >

    <tr class="table_td2"> 
      <td align="center" height=25></td>
 <td align="center"><B>ID</B></td>	
 <td align="center"><B><?php echo $_LANG_SKIN['Sort'];?></B></td>
<?php $td = 1;?>
<?php if(!empty($this->_tpl_vars['DisplayItem'] )): 
 foreach ($this->_tpl_vars['DisplayItem'] as  $this->_tpl_vars['key']=>$this->_tpl_vars['var']): ?>
<?php $td++;?>
		<td align="center"><B><?php echo $this->_tpl_vars["var"]["FieldTitle"];?></B></td>
	  <?php endforeach; endif;?>
      <td align="center"><B><?php echo $_LANG_SKIN['editor'];?></B></td>
      <td align="center"><B><?php echo $_LANG_SKIN['PublishDate'];?></B></td>
      <td align="center"><B><?php echo $_LANG_SKIN_GLOBAL['state'];?></B></td>
      <td colspan="5" align="center"><B><?php echo $_LANG_SKIN_GLOBAL['execute_op'];?></B></td>
        <td align="center" title="<?php echo $_LANG_SKIN['type'];?>"><B>T</B></td>
  </tr>

<?php if(!empty($this->_tpl_vars['pList'] )): 
 foreach ($this->_tpl_vars['pList'] as  $this->_tpl_vars['key']=>$this->_tpl_vars['var']): ?>
<!------onmouseover='this.style.backgroundColor="#FFFFFF"' 
                    onmouseout='this.style.backgroundColor=""'------>
	<?php if($this->_tpl_vars["var"]["PublishDate"] > time() ): ?>

	    <tr class="table_plan_td1" id="<?php echo $this->_tpl_vars["var"]["IndexID"];?>" > 

	<?php else: ?>
	    <tr class="table_td1" id="<?php echo $this->_tpl_vars["var"]["IndexID"];?>" onmouseover='this.style.backgroundColor="#FFFFFF"' 
                    onmouseout='this.style.backgroundColor=""' > 

	<?php endif;?>

 
      <td noWrap > <input type='checkbox' name='pData[]' value='<?php echo $this->_tpl_vars["var"]["IndexID"];?>' id="p_<?php echo $this->_tpl_vars["var"]["IndexID"];?>" ></td>
      <td align="center" noWrap   ><div class="subtitleholder" title="ContentID: <?php echo $this->_tpl_vars["var"]["ContentID"];?>"><?php echo $this->_tpl_vars["var"]["IndexID"];?></div></td>
	  <td noWrap > <input type='text' name='sort_<?php echo $this->_tpl_vars["var"]["IndexID"];?>' value='<?php echo $this->_tpl_vars["var"]["Sort"];?>'  size=1 style="border:1px #000000;" onclick="this.form.p_<?php echo $this->_tpl_vars["var"]["IndexID"];?>.checked = true;"></td>
	 <?php if(!empty($this->_tpl_vars['DisplayItem'] )): 
 foreach ($this->_tpl_vars['DisplayItem'] as  $this->_tpl_vars['keyIn']=>$this->_tpl_vars['varIn']): ?>
	 <?php if($this->_tpl_vars["var"]["Type"] == 1): ?>
		<?php if($this->_tpl_vars['keyIn'] == 0): ?>
      <td   noWrap  style="cursor:hand" id="<?php echo $this->_tpl_vars["var"]["pId"];?>">
<table  border="0"  cellpadding="0" cellspacing="0"  >
<tr>
<td>
	  <div class="titleholder">
	  &nbsp;&nbsp;
	  <?php if($this->_tpl_vars["var"]["Top"] !=0): ?>
	  [<?php echo $this->_tpl_vars["var"]["Top"];?>]&nbsp;<img src="../html/images/top.gif" border=0 align="middle">
	  <?php endif;?>
	  <?php if($this->_tpl_vars["var"]["Pink"] !=0): ?>
	  [<?php echo $this->_tpl_vars["var"]["Pink"];?>]&nbsp;<img src="../html/images/pink.gif" border=0 align="middle">
	  <?php endif;?>
	 
	  <A HREF="javascript:void(0);" onclick="doing('view','<?php echo $this->_tpl_vars["var"]["IndexID"];?>')" class="o" style="cursor:hand"   oncontextmenu="rightMenu('<?php echo $this->_tpl_vars["var"]["IndexID"];?>', '<?php echo $this->_tpl_vars["var"]["State"];?>','<?php echo $this->_tpl_vars["var"]["Type"];?>','<?php echo $this->_tpl_vars["var"]["Top"];?>','<?php echo $this->_tpl_vars["var"]["Pink"];?>','<?php echo $this->_tpl_vars["var"]["ContributionID"];?>');return false;" title="<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?>"><?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?></A>   
	  </div>
</td>
<td>
 <?php if($this->_tpl_vars["var"]["Photo"] != ''): ?>
	  <img src="../html/images/image.gif" border=0>
	  <?php endif;?>
</td>
</tr>
</table>

	  
	  </td>

		<?php else: ?>
      <td   noWrap   id="<?php echo $this->_tpl_vars["var"]["pId"];?>"><div class="subtitleholder">&nbsp;&nbsp;<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?> </div></td>

		<?php endif;?>
	<?php elseif($this->_tpl_vars["var"]["Type"] == 2 ): ?>
		<?php if($this->_tpl_vars['keyIn'] == 0): ?>
      <td   noWrap  style="cursor:hand" id="<?php echo $this->_tpl_vars["var"]["pId"];?>">

<table  border="0"  cellpadding="0" cellspacing="0"  >
<tr>
<td>
	  <div class="titleholder">
	  &nbsp;&nbsp;
	  <?php if($this->_tpl_vars["var"]["Top"] !=0): ?>
	   [<?php echo $this->_tpl_vars["var"]["Top"];?>]&nbsp;<img src="../html/images/top.gif" border=0 align="middle"> 
	  <?php endif;?>
	  <?php if($this->_tpl_vars["var"]["Pink"] !=0): ?>
	   [<?php echo $this->_tpl_vars["var"]["Pink"];?>]&nbsp;<img src="../html/images/pink.gif" border=0 align="middle"><?php echo $this->_tpl_vars["var"]["Pink"];?>
	  <?php endif;?>
	 
	  <A HREF="javascript:void(0);" onclick="doing('view','<?php echo $this->_tpl_vars["var"]["IndexID"];?>')" class="o" style="cursor:hand"   oncontextmenu="rightMenu('<?php echo $this->_tpl_vars["var"]["IndexID"];?>', '<?php echo $this->_tpl_vars["var"]["State"];?>','<?php echo $this->_tpl_vars["var"]["Type"];?>','<?php echo $this->_tpl_vars["var"]["Top"];?>','<?php echo $this->_tpl_vars["var"]["Pink"];?>','<?php echo $this->_tpl_vars["var"]["ContributionID"];?>');return false;" title="<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?>"><font color="blue"><?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?></font> </A>
	  </div>
</td> 
<td>
 <?php if($this->_tpl_vars["var"]["Photo"] != ''): ?>
	  <img src="../html/images/image.gif" border=0>
	  <?php endif;?>
</td>
</tr>
</table>


	  
	  </td>

		<?php else: ?>
      <td   noWrap   id="<?php echo $this->_tpl_vars["var"]["pId"];?>"><div class="subtitleholder">&nbsp;&nbsp;<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?> </div></td>
		<?php endif;?>

	<?php elseif($this->_tpl_vars["var"]["Type"] == 3 ): ?>
		<?php if($this->_tpl_vars['keyIn'] == 0): ?>
      <td   noWrap  style="cursor:hand" id="<?php echo $this->_tpl_vars["var"]["pId"];?>">
	  
				<table  border="0"  cellpadding="0" cellspacing="0"  >
				<tr>
				<td>
					  <div class="titleholder">&nbsp;&nbsp;	  
					  <?php if($this->_tpl_vars["var"]["Top"] !=0): ?>
					   [<?php echo $this->_tpl_vars["var"]["Top"];?>]&nbsp;<img src="../html/images/top.gif" border=0 align="middle"> 
					  <?php endif;?>
					  <?php if($this->_tpl_vars["var"]["Pink"] !=0): ?>
					   [<?php echo $this->_tpl_vars["var"]["Pink"];?>]&nbsp;<img src="../html/images/pink.gif" border=0 align="middle"> 
					  <?php endif;?>
					  <img src="../html/images/image.gif" border=0  align="absmiddle">

					  <A HREF="javascript:void(0);" onclick="doing('view','<?php echo $this->_tpl_vars["var"]["IndexID"];?>')" style="cursor:hand"   oncontextmenu="rightMenu('<?php echo $this->_tpl_vars["var"]["IndexID"];?>', '<?php echo $this->_tpl_vars["var"]["State"];?>','<?php echo $this->_tpl_vars["var"]["Type"];?>','<?php echo $this->_tpl_vars["var"]["Top"];?>','<?php echo $this->_tpl_vars["var"]["Pink"];?>');return false;" title="<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?>"><span class="photoLink"><?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?></span></A>
					  </div>

				</td>
				<td>
				 <?php if($this->_tpl_vars["var"]["Photo"] != ''): ?>
					  <img src="../html/images/image.gif" border=0>
					  <?php endif;?>
				</td>
				</tr>
				</table>

	  </td>

		<?php else: ?>
      <td   noWrap   id="<?php echo $this->_tpl_vars["var"]["pId"];?>"><div class="subtitleholder">&nbsp;&nbsp;<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?> </div></td>

		<?php endif;?>
	<?php elseif($this->_tpl_vars["var"]["Type"] == 4 ): ?>
		<?php if($this->_tpl_vars['keyIn'] == 0): ?>
      <td   noWrap  style="cursor:hand" id="<?php echo $this->_tpl_vars["var"]["pId"];?>">
	  
				<table  border="0"  cellpadding="0" cellspacing="0"  >
				<tr>
				<td>
					  <div class="titleholder">&nbsp;&nbsp;	  
					  <?php if($this->_tpl_vars["var"]["Top"] !=0): ?>
					   [<?php echo $this->_tpl_vars["var"]["Top"];?>]&nbsp;<img src="../html/images/top.gif" border=0 align="middle"> 
					  <?php endif;?>
					  <?php if($this->_tpl_vars["var"]["Pink"] !=0): ?>
					   [<?php echo $this->_tpl_vars["var"]["Pink"];?>]&nbsp;<img src="../html/images/pink.gif" border=0 align="middle"> 
					  <?php endif;?>

					  <A HREF="javascript:void(0);" onclick="doing('view','<?php echo $this->_tpl_vars["var"]["IndexID"];?>')" style="cursor:hand"   oncontextmenu="rightMenu('<?php echo $this->_tpl_vars["var"]["IndexID"];?>', '<?php echo $this->_tpl_vars["var"]["State"];?>','<?php echo $this->_tpl_vars["var"]["Type"];?>','<?php echo $this->_tpl_vars["var"]["Top"];?>','<?php echo $this->_tpl_vars["var"]["Pink"];?>');return false;" title="<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?>"><font color="red"><?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?></font></A>
					  </div>

				</td>
				<td>
				 <?php if($this->_tpl_vars["var"]["Photo"] != ''): ?>
					  <img src="../html/images/image.gif" border=0>
					  <?php endif;?>
				</td>
				</tr>
				</table>

	  </td>

		<?php else: ?>
      <td   noWrap   id="<?php echo $this->_tpl_vars["var"]["pId"];?>"><div class="subtitleholder">&nbsp;&nbsp;<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?> </div></td>

		<?php endif;?>	 
	 <?php else: ?>
		<?php if($this->_tpl_vars['keyIn'] == 0): ?>
      <td   noWrap  style="cursor:hand" id="<?php echo $this->_tpl_vars["var"]["pId"];?>">
	  

<table  border="0"  cellpadding="0" cellspacing="0"  >
<tr>
<td>
	  <div class="titleholder">&nbsp;&nbsp;	  
	  <?php if($this->_tpl_vars["var"]["Top"] !=0): ?>
	   [<?php echo $this->_tpl_vars["var"]["Top"];?>]&nbsp;<img src="../html/images/top.gif" border=0 align="middle"> 
	  <?php endif;?>
	  <?php if($this->_tpl_vars["var"]["Pink"] !=0): ?>
	   [<?php echo $this->_tpl_vars["var"]["Pink"];?>]&nbsp;<img src="../html/images/pink.gif" border=0 align="middle"> 
	  <?php endif;?>
	  <A HREF="javascript:void(0);" onclick="doing('view','<?php echo $this->_tpl_vars["var"]["IndexID"];?>')" style="cursor:hand"   oncontextmenu="rightMenu('<?php echo $this->_tpl_vars["var"]["IndexID"];?>', '<?php echo $this->_tpl_vars["var"]["State"];?>','<?php echo $this->_tpl_vars["var"]["Top"];?>','<?php echo $this->_tpl_vars["var"]["Pink"];?>');return false;" title="<?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?>"><span class="ltsep"><?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?> </span></A>
	  
	  </div>

</td>
<td>
 <?php if($this->_tpl_vars["var"]["Photo"] != ''): ?>
	  <img src="../html/images/image.gif" border=0>
	  <?php endif;?>
</td>
</tr>
</table>	  
	  
	  
	  
	  </td>

		<?php else: ?>
      <td   noWrap   id="<?php echo $this->_tpl_vars["var"]["pId"];?>"><div class="subtitleholder">&nbsp;&nbsp;<span class="ltsep"><?php echo $this->_tpl_vars["var"]["{$this->_tpl_vars['varIn']['FieldName']}"];?></span> </div></td>

		<?php endif;?>
		
	 <?php endif;?>

	 <?php endforeach; endif;?>
      <td align="center" noWrap  ><div class="subtitleholder" title="<?php echo $this->_tpl_vars["var"]["CreationUser"];?>"><?php echo $this->_tpl_vars["var"]["CreationUser"];?></div></td>
      <td align="center" noWrap ><div class="timeholder"><?php echo date('Y-m-d H:i', $this->_tpl_vars["var"]["PublishDate"]);?></div></td>
      <td align="center" noWrap  >
	  <div class="subtitleholder">
<?php if($this->_tpl_vars["var"]["State"] == 0 ): ?>
<?php echo $_LANG_SKIN['wait_publish'];?>
<?php elseif($this->_tpl_vars["var"]["PublishDate"] > time() ): ?>
<FONT  COLOR="#FF3300">	<?php echo $_LANG_SKIN['plan_publish'];?></FONT>
<?php elseif($this->_tpl_vars["var"]["State"] == 1 ): ?>
<FONT  COLOR="#3300CC">	<?php echo $_LANG_SKIN['published'];?></FONT>
<?php endif;?>	  
	  </div>
	  
	  </td>
     <td colspan="5" align="center" noWrap>
	    <?php if($this->_tpl_vars["NodeInfo"]["PublishMode"] != 0 && $this->_tpl_vars["var"]["State"] == 0 ): ?>
	  <A HREF="<?php echo $this->_tpl_vars["base_url"];?>o=publish&type=main&IndexID=<?php echo $this->_tpl_vars["var"]["IndexID"];?>&NodeID=<?php echo $this->_tpl_vars["NodeInfo"]["NodeID"];?>"><?php echo $_LANG_SKIN_GLOBAL['publish'];?></A>
	  <?php elseif($this->_tpl_vars["NodeInfo"]["PublishMode"] != 0 && $this->_tpl_vars["var"]["State"] == 1): ?>
	  <A HREF="<?php echo $this->_tpl_vars["var"]["URL"];?>" target="_blank" id="URL_<?php echo $this->_tpl_vars["var"]["IndexID"];?>"><?php echo $_LANG_SKIN_GLOBAL['browse'];?></A>
	  <?php endif;?>
	  <?php if($this->_tpl_vars["var"]["State"] == 1 && $this->_tpl_vars["var"]["Type"] != 2 && $this->_tpl_vars["var"]["Type"] != 4): ?>
	  <A HREF="<?php echo $this->_tpl_vars["base_url"];?>o=refresh&type=main&IndexID=<?php echo $this->_tpl_vars["var"]["IndexID"];?>&NodeID=<?php echo $this->_tpl_vars["NodeInfo"]["NodeID"];?>"><?php echo $_LANG_SKIN_GLOBAL['refresh'];?></A>
	  <?php endif;?>
	  
	  <?php if(( $this->_tpl_vars["var"]["Type"] == 1 || $this->_tpl_vars["var"]["Type"] == 3 || $this->_tpl_vars["var"]["Type"] == 4) && $this->_tpl_vars["var"]["Type"] != 2): ?>
	  <A HREF="plugins.php?sId=<?php echo $this->_tpl_vars["sId"];?>&plugin=base&o=admin_base::commentAdmin&IndexID=<?php echo $this->_tpl_vars["var"]["IndexID"];?>" ><?php echo $_LANG_SKIN['comment_admin'];?></A>
	  <A HREF="javascript:void(0);" onclick="doing('edit','<?php echo $this->_tpl_vars["var"]["IndexID"];?>')"><?php echo $_LANG_SKIN_GLOBAL['edit'];?></A>
	  <A HREF="<?php echo $this->_tpl_vars["base_url"];?>o=del&type=main&IndexID=<?php echo $this->_tpl_vars["var"]["IndexID"];?>&NodeID=<?php echo $this->_tpl_vars["NodeInfo"]["NodeID"];?>" onclick="return confirm('<?php echo $_LANG_SKIN_GLOBAL['confirm_del'];?>')"><?php echo $_LANG_SKIN_GLOBAL['del'];?></A> 
		
	  <?php else: ?>
	  <?php if($this->_tpl_vars["NodeInfo"]["NodeType"] != 2): ?>

	  <A HREF="<?php echo $this->_tpl_vars["base_url"];?>o=del&type=main&IndexID=<?php echo $this->_tpl_vars["var"]["IndexID"];?>&NodeID=<?php echo $this->_tpl_vars["NodeInfo"]["NodeID"];?>" onclick="return confirm('<?php echo $_LANG_SKIN_GLOBAL['confirm_del'];?>')"><?php echo $_LANG_SKIN_GLOBAL['del'];?></A> 
	  <?php endif;?>
	  <?php endif;?>

	 
	

	  
	  </td>
 <td align="center" width="28">
<?php if($this->_tpl_vars["var"]["Type"] == 0 ): ?>
<font color="#AAAAAA"><?php echo $_LANG_SKIN['link'];?></font>
<?php elseif($this->_tpl_vars["var"]["Type"] == 1 ): ?>
<?php echo $_LANG_SKIN['solid_link'];?>
<?php elseif($this->_tpl_vars["var"]["Type"] == 2 ): ?>
<font color="blue"><?php echo $_LANG_SKIN['index_link'];?></font>
<?php elseif($this->_tpl_vars["var"]["Type"] == 3 ): ?>
<font color="#669900"><?php echo $_LANG_SKIN['photo_link'];?></font>
<?php elseif($this->_tpl_vars["var"]["Type"] == 4 ): ?>
<font color="red"><?php echo $_LANG_SKIN['outer_link'];?></font>
<?php endif;?>
</td>
 </tr>
<?php endforeach; endif;?>

    <tr class="Tablelistbg"> 
      <td colspan="<?php echo $td+14;?>" align="left" bgcolor="#F5F5F5"> <table border="0" align="center"  cellpadding="0" cellspacing="0" width="100%">
          <tr> 
            <td align=left> 
            <input type="checkbox" name="chkall" value="on" onclick="CheckAll(this.form)" id="chkall"  > 
              <label for="chkall" ><?php echo $_LANG_SKIN_GLOBAL['select_all'];?></label>&nbsp;&nbsp;
			               
			 <select name="actionMap" id="actionMap" > 
          <option value="refresh"><?php echo $_LANG_SKIN_GLOBAL['refresh'];?></option>
            <option value="publish"><?php echo $_LANG_SKIN_GLOBAL['publish'];?></option>
          <option value="unpublish"><?php echo $_LANG_SKIN['unpublish'];?></option>
          <option value="tempUnPublish"><?php echo $_LANG_SKIN['tempUnPublish'];?></option>

		  
              <option value="copy"><?php echo $_LANG_SKIN_GLOBAL['copy'];?></option>
            <option value="cut"><?php echo $_LANG_SKIN_GLOBAL['move'];?></option>
             <option value="top"><?php echo $_LANG_SKIN['topselect'];?></option>
             <option value="pink"><?php echo $_LANG_SKIN['pinkselect'];?></option>
         <option value="del"><?php echo $_LANG_SKIN_GLOBAL['del'];?></option>
         <option value="destroy"><?php echo $_LANG_SKIN['destory'];?></option>
            <option value="createLink"><?php echo $_LANG_SKIN['create_link'];?></option>
              <option value="createIndexLink"><?php echo $_LANG_SKIN['create_index_link'];?></option>
               <option value="all_unpublish"><?php echo $_LANG_SKIN['all_unpublish'];?></option>
               <option value="all_tempUnpublish"><?php echo $_LANG_SKIN['all_tempUnpublish'];?></option>
                <option value="all_republish"><?php echo $_LANG_SKIN['all_republish'];?></option>


			  </select>

			  <input type="button" value="<?php echo $_LANG_SKIN_GLOBAL['go'];?>" class=button onclick="going(this.form,actionMap.options[actionMap.selectedIndex].value)"> 
         
            </td>
			<td height="20" align="right" nowrap="nowrap"> <INPUT name="go_display" TYPE="button" value="<?php echo $_LANG_SKIN['display'];?>" onclick="doing('display_record')" ></td>
	  <td   height="20" nowrap="nowrap" align="right"  width=80> &nbsp;&nbsp;<INPUT TYPE="text" NAME="offset" size=1 value=<?php echo $this->_tpl_vars["offset"];?>> <?php echo $_LANG_SKIN['display_record'];?> 
       
   </td>
          </tr>
        </table></td>
    </tr>

	 <tr class="Tablelistbg"> 
      <td colspan="<?php echo $td+15;?>" align="center" bgcolor="#F5F5F5">
	  
 			<input name="year" type="text" class="button" id="dTime" onFocus="CreateMonthView(this)"   onBlur="DeleteMonthView(this)" value="<?php echo date("Y-m-d");?>"> 
                <select name="hour">
                 <?php
				 	$hour = date("H");

					for($i=0;$i<=24;$i++) {
						if($i<10) {
							$j = '0'.$i;
							if($j == $hour)
								$output_hour .= "<option value=\"$j\" selected>$j</option>";
							else
								$output_hour .= "<option value=\"$j\">$j</option>";
						} else {
							if($i == $hour)
								$output_hour .= "<option value=\"$i\" selected>$i</option>";
							else
								$output_hour .= "<option value=\"$i\">$i</option>";
							
						}
					}

					echo $output_hour;
				 ?>
				  
                  
                </select>
                <?php echo $_LANG_SKIN_GLOBAL['hour'];?> 
                <select name="minute">
                 <?php
				 	$minute = date("i");
					for($i=0;$i<=60;$i++) {
						if($i<10) {
							$j = '0'.$i;
							if($j == $minute)
								$output_minute  .= "<option value=\"$j\" selected>$j</option>";
							else
								$output_minute  .= "<option value=\"$j\">$j</option>";
						} else {
							if($i == $minute)
								$output_minute  .= "<option value=\"$i\" selected>$i</option>";
							else
								$output_minute  .= "<option value=\"$i\">$i</option>";
							
						}
					}	
					
					echo $output_minute;
				 
				 ?>
                  
                </select>
                <?php echo $_LANG_SKIN_GLOBAL['minute'];?>  <select name="second">
                 <?php 
				 	$second = date("s");
					for($i=0;$i<=60;$i++) {
						if($i<10) {
							$j = '0'.$i;
							if($j == $second)
								$output_second  .= "<option value=\"$j\" selected>$j</option>";
							else
								$output_second  .= "<option value=\"$j\">$j</option>";
						} else {
							if($i == $second)
								$output_second  .= "<option value=\"$i\" selected>$i</option>";
							else
								$output_second  .= "<option value=\"$i\">$i</option>";
							
						}
					}

					echo $output_second ;
				 
				 ?>
                 
                </select>
                <?php echo $_LANG_SKIN_GLOBAL['second'];?>  	

			 <input type='checkbox' name='setPublishDate' value='1'   id='setPublishDate' checked><label for="setPublishDate"><?php echo $_LANG_SKIN['setPublishDate'];?></label>
			 <input type="button" value="<?php echo $_LANG_SKIN['planPublish'];?>" class=button onclick="going(this.form,'planPublish')"> 

 	  
	  </td></tr>
	<INPUT TYPE="hidden" name="referer" value ="" >
  </form>


  <tr class="table_td1"> 
    <td colspan="<?php echo $td+13;?>" height=25 >
	<table border=0 align="right">
	<tr>
	<td align=right>
	<?php echo sprintf($_LANG_SKIN['record'], $this->_tpl_vars["recordInfo"]["currentPage"]  , $this->_tpl_vars["recordInfo"]["pageNum"], $this->_tpl_vars["recordInfo"]["offset"], $this->_tpl_vars["recordInfo"]["from"], $this->_tpl_vars["recordInfo"]["to"], $this->_tpl_vars["recordInfo"]["recordNum"] );?>
	 <?php echo $this->_tpl_vars["pagelist"];?> &nbsp;&nbsp;&nbsp;&nbsp;
	</td>
	
	</tr>
	</table>
	 </td>
  </tr>
  </tbody> 
</table>
<CENTER><?php echo $_LANG_SKIN['explain'];?>
</CENTER><?php include("../sysdata/templates_c/%%c_^@skin@admin@footer.html");?>
